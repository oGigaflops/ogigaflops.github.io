<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="styles.css">
</head>
<body style="display: flex; flex-direction: column; align-items: center; justify-items: center; width: 100vw; margin:auto; font-size: 12px;">
    <h1 id="MSG" style="font-size: 5rem;">???</h1>
    <h2 id="SERIAL" style="font-size: 3rem;">###</h2>
    <h2 id="RECORDS" style="font-size: 3rem;">###</h2>
    <button onclick="read()" style="width: 50vw; height: 6rem;">LER</button>
</body>

<script>

    if ("NDEFReader" in window) {
        document.getElementById("MSG").innerHTML = "NDEFReader is supported";
    } else {
        document.getElementById("MSG").innerHTML = "NDEFReader is not supported";
    }

    const ndef = new NDEFReader();

    function read() {
        const ndef = new NDEFReader();
        ndef.scan().then(() => {
            console.log("Scan started successfully.");

            ndef.onreadingerror = () => {
                document.getElementById("MSG").innerHTML = "Cannot read data from the NFC tag. Try another one?";
            };
            ndef.onreading = event => {
                document.getElementById("MSG").innerHTML = "NDEF message read.";
                document.getElementById("SERIAL").innerHTML = JSON.stringify(event);
            };

        ndef.addEventListener("reading", ({ message, serialNumber }) => {
            document.getElementById("MSG").innerHTML = `Serial Number: ${serialNumber}`;
            document.getElementById("SERIAL").innerHTML = `Serial Number: ${serialNumber}`;
            document.getElementById("RECORDS").innerHTML = `Records: (${message.records.length})`;
        }

        }).catch(error => {
            document.getElementById("MSG").innerHTML = `Error! Scan failed to start: ${error}.`;
        });
    };

</script>

</html>