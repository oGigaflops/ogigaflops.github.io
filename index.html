<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NFC</title>
    <script>
        // Add a global error event listener early on in the page load, to help ensure that browsers
        // which don't support specific functionality still end up displaying a meaningful message.
        window.addEventListener('error', function(error) {
          if (ChromeSamples && ChromeSamples.setStatus) {
            console.error(error);
            ChromeSamples.setStatus(error.message + ' (Your browser may not support this feature.)');
            error.preventDefault();
          }
        });
      </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>
<body style="display: flex; flex-direction: column; align-items: center; justify-items: center; width: 100vw; margin:auto; font-size: 12px;">
    <h1 id="MSG" style="font-size: 2rem;">???</h1>
    <h2 id="SERIAL" style="font-size: 1rem;">###</h2>
    <h2 id="RECORDS" style="font-size: 1rem;">###</h2>
    <button id="scanButton" class="btn Button">LER</button>
</body>

<script>

scanButton.addEventListener("click", async () => {
    document.getElementById("MSG").innerHTML = "User clicked scan button";

  try {
    const ndef = new NDEFReader();
    await ndef.scan();
    document.getElementById("MSG").innerHTML = "Scan started";

    ndef.addEventListener("readingerror", () => {
        document.getElementById("MSG").innerHTML = "Error reading tag";
    });

    ndef.addEventListener("reading", ({ message, serialNumber }) => {
        document.getElementById("MSG").innerHTML = "Done.";
        document.getElementById("SERIAL").innerHTML = `Serial Number: ${serialNumber}`;
        document.getElementById("RECORDS").innerHTML = `Records: (${message.records.length})`;
    });
  } catch (error) {
    document.getElementById("MSG").innerHTML = "Argh! " + error;
  }
});

/*    const ndef = new NDEFReader();

    function read() {
        const ndef = new NDEFReader();
        ndef.scan().then(() => {
            console.log("Scan started successfully.");

            ndef.onreadingerror = () => {
                document.getElementById("MSG").innerHTML = "Cannot read data from the NFC tag. Try another one?";
            };
            ndef.onreading = event => {
                document.getElementById("MSG").innerHTML = "NDEF message read.";
                document.getElementById("SERIAL").innerHTML = JSON.stringify(event);
            };

        ndef.addEventListener("reading", ({ message, serialNumber }) => {
            document.getElementById("MSG").innerHTML = `Serial Number: ${serialNumber}`;
            document.getElementById("SERIAL").innerHTML = `Serial Number: ${serialNumber}`;
            document.getElementById("RECORDS").innerHTML = `Records: (${message.records.length})`;
        }

        }).catch(error => {
            document.getElementById("MSG").innerHTML = `Error! Scan failed to start: ${error}.`;
        });
    };

*/

</script>

</html>