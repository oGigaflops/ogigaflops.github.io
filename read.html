<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAG</title>
    <link rel="stylesheet" href="style.css">
    <script>
        // Add a global error event listener early on in the page load, to help ensure that browsers
        // which don't support specific functionality still end up displaying a meaningful message.
        window.addEventListener('error', function (error) {
            if (ChromeSamples && ChromeSamples.setStatus) {
                console.error(error);
                ChromeSamples.setStatus(error.message + ' (Your browser may not support this feature.)');
                error.preventDefault();
            }
        });
    </script>
</head>
<body>
    <h3 class="title">TAGs</h3>
    <div class="container">
        <div class="form">
            <input type="text" id="id" placeholder="referência">
            <input type="text" id="design" placeholder="designação">
            <input type="text" id="stock" placeholder="stock">
        </div>
        <button id="scanButton"><span>LER</span></button>
        
    </div>

    <script>

    scanButton.addEventListener("click", async () => {
        
        try {
        const ndef = new NDEFReader();
        await ndef.scan();
        document.getElementById("id").value = "Rastreio iniciado";
        
        ndef.addEventListener("readingerror", () => {
            document.getElementById("id").value = "Erro lendo tag";
        });

        ndef.addEventListener("reading", ({ message, serialNumber }) => {

            if (message.records.length == 0 || message.records[0].recordType == "empty") {
                document.getElementById("id").value = "Tag vazia";   
            } else
            document.getElementById("id").value = serialNumber;
/*             document.getElementById("SERIAL").innerHTML = `Número de série: ${serialNumber}`;
            document.getElementById("RECORDS").innerHTML = `Registos: (${message.records.length})`;
            document.getElementById("CONTENT").innerHTML = `Conteúdo: ${record.data}`; */
            });
        } catch (error) {
        document.getElementById("id").value = "Erro: " + error;
        }
    });
    
    </script>

</body>
</html>